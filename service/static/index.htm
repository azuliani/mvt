<!DOCTYPE html>
<html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
 
<title>WebSockets Client</title>
 
<script>

document.addEventListener("DOMContentLoaded", function() {
  
  var ws = null;

  function start(){

    var loc = window.location
    ws = new WebSocket("ws://" + loc.hostname + ":" + loc.port + "/pushupdates");
    ws.onopen = function(){
      console.log('connected!');
    };
    ws.onmessage = function(e){
      console.log(e.data);
    };
    socket.onmessage = function(msg){
      var obj = JSON.parse(msg.data);
      console.log(obj)
      if (obj.totalpushes || obj.totalpushes === 0){
          $('#pushes').text(obj.totalpushes);
      }
      if (obj.ping) {
          refreshPing();
      }
    }

    ws.onclose = function(){
      console.log('closed!');
      //reconnect now
      check();
    };

  }

  function check(){
    if(!ws || ws.readyState == 3) start();
  }

  start();

  setInterval(check, 5000);

});



</script>

</head>
<body>
<div id="wrapper">
 
    <div id="container">
 
        <h1>Totaal # drukken op de knop:</h1>
    
        <span id="pushes" style="font-size: 230pt">?</span>
        
 
    </div><!-- #container -->
 
</div>
</body>
</html>
